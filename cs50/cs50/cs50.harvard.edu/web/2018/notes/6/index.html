<!DOCTYPE html><html lang="en-us">
<!-- Mirrored from cs50.harvard.edu/web/2018/notes/6/ by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 31 May 2020 07:07:59 GMT -->
<head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta property="og:description" content="This course picks up where Harvard University's CS50 leaves off, diving more deeply into the design and implementation of web apps with Python, JavaScript, and SQL using frameworks like Flask, Django, and Bootstrap. Topics include database design, scalability, security, and user experience. Through hands-on projects, students learn to write and use APIs, create interactive UIs, and leverage cloud services like GitHub and Heroku. By semester's end, students emerge with knowledge and experience in principles, languages, and tools that empower them to design and deploy applications on the Internet.">

<meta property="og:image" content="../../../../../img.youtube.com/vi/24Kf3v7kZyE/maxresdefault.jpg"><meta property="og:title" content="Front Ends - CS50's Web Programming with Python and JavaScript"><link href="../../faviconb8b0.ico?1590121405" rel="icon">

<!-- https://fontawesome.com/how-to-use/on-the-web/referencing-icons/basic-use -->
<link href="../../assets/%40fortawesome/fontawesome-free/css/all.minb8b0.css?1590121405" rel="stylesheet">

<link href="../../assets/pageb8b0.css?1590121405" rel="stylesheet">

<!-- http://getbootstrap.com/docs/4.3/getting-started/introduction/ -->
<script src="../../assets/jquery/dist/jquery.minb8b0.js?1590121405"></script>
<script src="../../assets/popper.js/dist/umd/popper.minb8b0.js?1590121405"></script>
<script src="../../assets/bootstrap/dist/js/bootstrap.minb8b0.js?1590121405"></script>

<!-- https://github.com/pellepim/jstimezonedetect -->
<script src="../../assets/jstz.minb8b0.js?1590121405"></script>

<!-- https://momentjs.com/, https://momentjs.com/timezone/ -->
<script src="../../assets/moment.minb8b0.js?1590121405"></script>
<script src="../../assets/moment-timezone-with-data.minb8b0.js?1590121405"></script>



<script src="../../assets/jekyll-theme-cs50b8b0.js?1590121405"></script>

<title>Front Ends - CS50's Web Programming with Python and JavaScript</title>
</head>

    <body>

        

        <div class="container-fluid">

            <div class="row">

                <aside class="col-md">
 
                    <header><h1 data-id="cs50s-web-programming-with-python-and-javascript"><a href="../../index.html">CS50’s Web Programming with Python and JavaScript</a></h1>

<p>OpenCourseWare</p>

<p><a href="https://brianyu.me/">Brian Yu</a><br>
<a href="mailto:brian@cs.harvard.edu">brian@cs.harvard.edu</a></p>

<p><a href="https://cs.harvard.edu/malan/">David J. Malan</a><br>
<a href="mailto:malan@harvard.edu">malan@harvard.edu</a><br>
<a href="https://www.facebook.com/dmalan" class="pr-1"><i class="fab fa-facebook-f"></i></a>
<a href="https://github.com/dmalan" class="pr-1"><i class="fab fa-github"></i></a>
<a href="https://www.instagram.com/davidjmalan/" class="pr-1"><i class="fab fa-instagram"></i></a>
<a href="https://www.linkedin.com/in/malan/" class="pr-1"><i class="fab fa-linkedin-in"></i></a>
<a href="https://www.quora.com/profile/David-J-Malan" class="pr-1"><i class="fab fa-quora"></i></a>
<a href="https://twitter.com/davidjmalan" class="pr-1"><i class="fab fa-twitter"></i></a></p></header>

                    

                    <button aria-controls="nav" aria-expanded="false" class="btn btn-sm collapsed d-md-none" data-target="aside > nav" data-toggle="collapse">
                        Menu
                    </button>

                    <nav class="collapse d-md-block" id="nav"><hr>

<ol start="0">
  <li><a href="../../index.html#git">Git</a></li>
  <li><a href="../../index.html#html-css">HTML, CSS</a></li>
  <li><a href="../../index.html#flask">Flask</a></li>
  <li><a href="../../index.html#sql">SQL</a></li>
  <li><a href="../../index.html#orms-apis">ORMs, APIs</a></li>
  <li><a href="../../index.html#javascript">JavaScript</a></li>
  <li><a href="../../index.html#front-ends">Front Ends</a></li>
  <li><a href="../../index.html#django">Django</a></li>
  <li><a href="../../index.html#testing-cicd">Testing, CI/CD</a></li>
  <li><a href="../../index.html#github-travis-ci">GitHub, Travis CI</a></li>
  <li><a href="../../index.html#scalability">Scalability</a></li>
  <li><a href="../../index.html#security">Security</a></li>
</ol>

<hr>

<p><a href="../../certificate/index.html">CS50 Certificate</a></p>

<hr>

<ul>
  <li data-marker="*"><a href="https://cs50.harvard.edu/web/ed">Ed Discussion</a> for Q&amp;A</li>
  <li data-marker="*" class="small"><a href="../../quickstart.pdf">Quick Start Guide</a></li>
</ul>

<hr>

<ul class="small">
  <li data-marker="*"><a href="https://cs50.edx.org/web">edX</a></li>
  <li data-marker="*"><a href="https://itunes.apple.com/us/course/cs50s-web-programming-with-python-and-javascript/id1409824690">iTunes U</a></li>
  <li data-marker="*"><a href="https://www.youtube.com/playlist?list=PLhQjrBD2T382hIW-IsOVuXP1uMzEvmcE5">YouTube</a></li>
</ul>

<hr>

<ul class="small">
  <li data-marker="*"><a href="https://discord.gg/T8QZqRx">Discord</a></li>
  <li data-marker="*"><a href="https://www.facebook.com/groups/cs50/">Facebook Group</a></li>
  <li data-marker="*"><a href="https://www.facebook.com/cs50/">Facebook Page</a></li>
  <li data-marker="*"><a href="https://instagram.com/cs50">Instagram</a></li>
  <li data-marker="*"><a href="https://www.linkedin.com/groups/7437240/">LinkedIn Group</a></li>
  <li data-marker="*"><a href="https://www.quora.com/topic/CS50">Quora</a></li>
  <li data-marker="*"><a href="https://www.snapchat.com/add/cs50">Snapchat</a></li>
  <li data-marker="*"><a href="https://twitter.com/cs50">Twitter</a></li>
  <li data-marker="*"><a href="http://www.youtube.com/subscription_center?add_user=cs50tv">YouTube</a></li>
</ul>

<hr>

<p><a href="https://cs50.harvardshop.com/"><img src="https://drive.google.com/uc?export=view&amp;id=1oWgwFDv5cvtev23emjNlZfK64MEOmVu9" alt="Harvard Shop"></a></p>

<hr></nav>

                    <footer><p><a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" class="small">CC BY-NC-SA 4.0</a></p></footer>

                </aside>

                <main class="col-md markdown-body">

                    <h1 id="front-ends">Front Ends</h1>

<h2 id="single-page-apps">Single-Page Apps</h2>

<ul>
  <li data-marker="*">Single-page apps take content that would ordinarily be on multiple different pages (or routes) and combine them into a single page that pulls new information from the server whenever it’s needed (through methods such as AJAX).</li>
  <li data-marker="*">For a starting point, this application uses multiple pages.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">"/"</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">first</span><span class="p">():</span>
      <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">"first.html"</span><span class="p">)</span>

  <span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">"/second"</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">second</span><span class="p">():</span>
      <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">"second.html"</span><span class="p">)</span>

  <span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">"/third"</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">third</span><span class="p">():</span>
      <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">"third.html"</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li data-marker="*">Here’s the layout template for these pages.
    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nt">&lt;html&gt;</span>
      <span class="nt">&lt;head&gt;</span>
          <span class="nt">&lt;title&gt;</span>My Webpage<span class="nt">&lt;/title&gt;</span>
      <span class="nt">&lt;/head&gt;</span>
      <span class="nt">&lt;body&gt;</span>
          <span class="nt">&lt;ul</span> <span class="na">id=</span><span class="s">"nav"</span><span class="nt">&gt;</span>
              <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">""</span><span class="nt">&gt;</span>First Page<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
              <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">""</span><span class="nt">&gt;</span>Second Page<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
              <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">""</span><span class="nt">&gt;</span>Third Page<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
          <span class="nt">&lt;/ul&gt;</span>
          <span class="nt">&lt;hr&gt;</span>
            
          {% block body %}
          {% endblock %}
            
      <span class="nt">&lt;/body&gt;</span>
  <span class="nt">&lt;/html&gt;</span>
</code></pre></div>    </div>
    <ul>
      <li data-marker="*">The navigation bar is simply an unordered list of links.</li>
    </ul>
  </li>
  <li data-marker="*">Given that these pages all have the simple function of displaying text, <code class="highlighter-rouge">application.py</code> can be reworked to run on a single route.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">"/"</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
      <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">"index.html"</span><span class="p">)</span>

  <span class="n">texts</span> <span class="o">=</span> <span class="p">[</span><span class="s">"text 1"</span><span class="p">,</span> <span class="s">"text 2"</span><span class="p">,</span> <span class="s">"text 3"</span><span class="p">]</span>

  <span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">"/first"</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">first</span><span class="p">():</span>
      <span class="k">return</span> <span class="n">texts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

  <span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">"/second"</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">second</span><span class="p">():</span>
      <span class="k">return</span> <span class="n">texts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

  <span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">"/third"</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">third</span><span class="p">():</span>
      <span class="k">return</span> <span class="n">texts</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</code></pre></div>    </div>
    <ul>
      <li data-marker="*">Note that the other ‘routes’ don’t return a new webpage, but rather just the text that should be displayed.</li>
    </ul>
  </li>
  <li data-marker="*">In order to process this structure, JavaScript must be added to <code class="highlighter-rouge">index.html</code>.
    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nt">&lt;html&gt;</span>
      <span class="nt">&lt;head&gt;</span>
          <span class="nt">&lt;script&gt;</span>
              <span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">DOMContentLoaded</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>

                  <span class="c1">// Start by loading first page.</span>
                  <span class="nx">load_page</span><span class="p">(</span><span class="dl">'</span><span class="s1">first</span><span class="dl">'</span><span class="p">);</span>

                  <span class="c1">// Set links up to load new pages.</span>
                  <span class="nb">document</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="dl">'</span><span class="s1">.nav-link</span><span class="dl">'</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">link</span> <span class="o">=&gt;</span> <span class="p">{</span>
                      <span class="nx">link</span><span class="p">.</span><span class="nx">onclick</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
                          <span class="nx">load_page</span><span class="p">(</span><span class="nx">link</span><span class="p">.</span><span class="nx">dataset</span><span class="p">.</span><span class="nx">page</span><span class="p">);</span>
                          <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
                      <span class="p">};</span>
                  <span class="p">});</span>
              <span class="p">});</span>

              <span class="c1">// Renders contents of new page in main view.</span>
              <span class="kd">function</span> <span class="nx">load_page</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
                  <span class="kd">const</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
                  <span class="nx">request</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">'</span><span class="s1">GET</span><span class="dl">'</span><span class="p">,</span> <span class="s2">`/</span><span class="p">${</span><span class="nx">name</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
                  <span class="nx">request</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
                      <span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">request</span><span class="p">.</span><span class="nx">responseText</span><span class="p">;</span>
                      <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">#body</span><span class="dl">'</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">response</span><span class="p">;</span>
                  <span class="p">};</span>
                  <span class="nx">request</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>
              <span class="p">}</span>
          <span class="nt">&lt;/script&gt;</span>
      <span class="nt">&lt;/head&gt;</span>
      <span class="nt">&lt;body&gt;</span>
          <span class="nt">&lt;ul</span> <span class="na">id=</span><span class="s">"nav"</span><span class="nt">&gt;</span>
              <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">""</span> <span class="na">class=</span><span class="s">"nav-link"</span> <span class="na">data-page=</span><span class="s">"first"</span><span class="nt">&gt;</span>First Page<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
              <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">""</span> <span class="na">class=</span><span class="s">"nav-link"</span> <span class="na">data-page=</span><span class="s">"second"</span><span class="nt">&gt;</span>Second Page<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
              <span class="nt">&lt;li&gt;&lt;a</span> <span class="na">href=</span><span class="s">""</span> <span class="na">class=</span><span class="s">"nav-link"</span> <span class="na">data-page=</span><span class="s">"third"</span><span class="nt">&gt;</span>Third Page<span class="nt">&lt;/a&gt;&lt;/li&gt;</span>
          <span class="nt">&lt;/ul&gt;</span>
          <span class="nt">&lt;hr&gt;</span>
          <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"body"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;/div&gt;</span>
      <span class="nt">&lt;/body&gt;</span>
  <span class="nt">&lt;/html&gt;</span>
</code></pre></div>    </div>
    <ul>
      <li data-marker="*"><code class="highlighter-rouge">load_page</code> makes an AJAX request to the server to get the text that should be displayed and puts in the <code class="highlighter-rouge">body</code> <code class="highlighter-rouge">div</code>.</li>
    </ul>
  </li>
  <li data-marker="*">This new single-page implementation avoids reloading the page repeatedly just to display very similar content (e.g. the same navigation bar). However, this eliminates the URL’s functionality as a locator, because all the content is on the same route.</li>
</ul>

<h3 t="15m06s" id="html5-history-api">HTML5 History API</h3>

<ul>
  <li data-marker="*">The HTMuL5 History API allows for the manipulation of a browser’s history and URL even if the page is still being implemented with a single-page design. Whenever an new ‘page’ is accessed, the client can ‘push’ a new URL state.</li>
  <li data-marker="*">The changes to the JavaScript code are inside the <code class="highlighter-rouge">load_page</code> function.
    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">function</span> <span class="nx">load_page</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
      <span class="nx">request</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">'</span><span class="s1">GET</span><span class="dl">'</span><span class="p">,</span> <span class="s2">`/</span><span class="p">${</span><span class="nx">name</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
      <span class="nx">request</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">request</span><span class="p">.</span><span class="nx">responseText</span><span class="p">;</span>
          <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">#body</span><span class="dl">'</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">response</span><span class="p">;</span>

          <span class="c1">// Push state to URL.</span>
          <span class="nb">document</span><span class="p">.</span><span class="nx">title</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
          <span class="nx">history</span><span class="p">.</span><span class="nx">pushState</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">name</span><span class="p">);</span>
      <span class="p">};</span>
      <span class="nx">request</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>
  <span class="p">}</span>
</code></pre></div>    </div>
    <ul>
      <li data-marker="*"><code class="highlighter-rouge">document.title</code> is just an aesthetic property that is set to reflect the current page.</li>
      <li data-marker="*">In the <code class="highlighter-rouge">history.pushState()</code> function, which is used to change the browser’s history, the first argument is any data that should be associated with the push, the second argument is the title of the page being pushed, and the third argument is the URL being pushed.</li>
    </ul>
  </li>
  <li data-marker="*">One flaw with this, though, is that the full multi-page behavior is not truly being emulated. If a user tries to use the back button in their browser, the URL will change, but not the content. To remedy this, the full, stack-like behavior of the HTML5 History API can be used. Going back in history should just ‘pop’ whatever the URL is on top off of the stack.
    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="c1">// Renders contents of new page in main view.</span>
  <span class="kd">function</span> <span class="nx">load_page</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
      <span class="nx">request</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">'</span><span class="s1">GET</span><span class="dl">'</span><span class="p">,</span> <span class="s2">`/</span><span class="p">${</span><span class="nx">name</span><span class="p">}</span><span class="s2">`</span><span class="p">);</span>
      <span class="nx">request</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">request</span><span class="p">.</span><span class="nx">responseText</span><span class="p">;</span>
          <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">#body</span><span class="dl">'</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">response</span><span class="p">;</span>

          <span class="c1">// Push state to URL.</span>
          <span class="nb">document</span><span class="p">.</span><span class="nx">title</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
          <span class="nx">history</span><span class="p">.</span><span class="nx">pushState</span><span class="p">({</span><span class="dl">'</span><span class="s1">title</span><span class="dl">'</span><span class="p">:</span> <span class="nx">name</span><span class="p">,</span> <span class="dl">'</span><span class="s1">text</span><span class="dl">'</span><span class="p">:</span> <span class="nx">response</span><span class="p">},</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">name</span><span class="p">);</span>
      <span class="p">};</span>
      <span class="nx">request</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>
  <span class="p">}</span>

  <span class="c1">// Update text on popping state.</span>
  <span class="nb">window</span><span class="p">.</span><span class="nx">onpopstate</span> <span class="o">=</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="kd">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">state</span><span class="p">;</span>
      <span class="nb">document</span><span class="p">.</span><span class="nx">title</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">title</span><span class="p">;</span>
      <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">#body</span><span class="dl">'</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">text</span><span class="p">;</span>
  <span class="p">};</span>
</code></pre></div>    </div>
    <ul>
      <li data-marker="*">Now, when pushing a new state, title and text data is being pushed with it.</li>
      <li data-marker="*">When the state is popped, <code class="highlighter-rouge">e</code>, the event that just took place, has a <code class="highlighter-rouge">state</code> property that contains all the data that was pushed with that state. Then, that data is just used to update the contents of the page as expected.</li>
    </ul>
  </li>
</ul>

<h2 id="window-and-document">Window and Document</h2>

<ul>
  <li data-marker="*">The <code class="highlighter-rouge">window</code> and <code class="highlighter-rouge">document</code> variables, which have been seen in past examples, are just examples of JavaScripts objects on which operations can be performed and that have properties that can be accessed. In particular, they contain information about their size and position.
    <ul>
      <li data-marker="*"><code class="highlighter-rouge">window.innerWidth</code> : window width</li>
      <li data-marker="*"><code class="highlighter-rouge">window.innerHeight</code> : window height</li>
      <li data-marker="*"><code class="highlighter-rouge">document.body.offsetHeight</code> : the entire height of the HTML body’s document, of which the window height is likely just a small porition</li>
      <li data-marker="*"><code class="highlighter-rouge">window.scrollY</code> : how far down the page has been scrolled (in pixels)</li>
    </ul>
  </li>
  <li data-marker="*">One potential use of these properties is to be able to detect if the user has scrolled to the bottom of the page.
    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nb">window</span><span class="p">.</span><span class="nx">onscroll</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">----</span><span class="dl">'</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">scrollY</span><span class="p">);</span>
      <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">offsetHeight</span><span class="p">);</span>
      <span class="k">if</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span> <span class="o">+</span> <span class="nb">window</span><span class="p">.</span><span class="nx">scrollY</span> <span class="o">&gt;=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">offsetHeight</span><span class="p">)</span> <span class="p">{</span>
          <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">body</span><span class="dl">'</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">background</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">green</span><span class="dl">'</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
          <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">body</span><span class="dl">'</span><span class="p">).</span><span class="nx">style</span><span class="p">.</span><span class="nx">background</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">white</span><span class="dl">'</span><span class="p">;</span>
      <span class="p">}</span>
  <span class="p">};</span>
</code></pre></div>    </div>
    <ul>
      <li data-marker="*"><code class="highlighter-rouge">console.log</code> is essentially a print statement that prints to the web browsers’s console.</li>
      <li data-marker="*">All this does is change the background color of the web page to green when the bottom of the document has been reached, which is detected using the mathematical relationship between <code class="highlighter-rouge">window</code> and <code class="highlighter-rouge">document</code> properties.</li>
    </ul>
  </li>
  <li data-marker="*">A more useful application of this bottom-detection would be the dynamic loading of more content when the bottom of a webpage has been reached. <code class="highlighter-rouge">application.py</code> for such a webpage could look like this.
    <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kn">import</span> <span class="nn">time</span>

  <span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">jsonify</span><span class="p">,</span> <span class="n">render_template</span><span class="p">,</span> <span class="n">request</span>

  <span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>

  <span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">"/"</span><span class="p">)</span>
  <span class="k">def</span> <span class="nf">index</span><span class="p">():</span>
      <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s">"index.html"</span><span class="p">)</span>

  <span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">"/posts"</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">"POST"</span><span class="p">])</span>
  <span class="k">def</span> <span class="nf">posts</span><span class="p">():</span>

      <span class="c1"># Get start and end point for posts to generate.
</span>      <span class="n">start</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"start"</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span>
      <span class="n">end</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">"end"</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">start</span> <span class="o">+</span> <span class="mi">9</span><span class="p">))</span>

      <span class="c1"># Generate list of posts.
</span>      <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
          <span class="n">data</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="s">f"Post #</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>

      <span class="c1"># Artificially delay speed of response.
</span>      <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

      <span class="c1"># Return list of posts.
</span>      <span class="k">return</span> <span class="n">jsonify</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div>    </div>
  </li>
  <li data-marker="*"><code class="highlighter-rouge">index.html</code> (a little more complex now)
    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nt">&lt;html&gt;</span>
      <span class="nt">&lt;head&gt;</span>
          <span class="nt">&lt;script&gt;</span>
              <span class="c1">// Start with first post.</span>
              <span class="kd">let</span> <span class="nx">counter</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

              <span class="c1">// Load posts 20 at a time.</span>
              <span class="kd">const</span> <span class="nx">quantity</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span>

              <span class="c1">// When DOM loads, render the first 20 posts.</span>
              <span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">DOMContentLoaded</span><span class="dl">'</span><span class="p">,</span> <span class="nx">load</span><span class="p">);</span>

              <span class="c1">// If scrolled to bottom, load the next 20 posts.</span>
              <span class="nb">window</span><span class="p">.</span><span class="nx">onscroll</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
                  <span class="k">if</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span> <span class="o">+</span> <span class="nb">window</span><span class="p">.</span><span class="nx">scrollY</span> <span class="o">&gt;=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">offsetHeight</span><span class="p">)</span> <span class="p">{</span>
                      <span class="nx">load</span><span class="p">();</span>
                  <span class="p">}</span>
              <span class="p">};</span>

              <span class="c1">// Load next set of posts.</span>
              <span class="kd">function</span> <span class="nx">load</span><span class="p">()</span> <span class="p">{</span>

                  <span class="c1">// Set start and end post numbers, and update counter.</span>
                  <span class="kd">const</span> <span class="nx">start</span> <span class="o">=</span> <span class="nx">counter</span><span class="p">;</span>
                  <span class="kd">const</span> <span class="nx">end</span> <span class="o">=</span> <span class="nx">start</span> <span class="o">+</span> <span class="nx">quantity</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span>
                  <span class="nx">counter</span> <span class="o">=</span> <span class="nx">end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>

                  <span class="c1">// Open new request to get new posts.</span>
                  <span class="kd">const</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
                  <span class="nx">request</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">'</span><span class="s1">POST</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">/posts</span><span class="dl">'</span><span class="p">);</span>
                  <span class="nx">request</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
                      <span class="kd">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">responseText</span><span class="p">);</span>
                      <span class="nx">data</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">add_post</span><span class="p">);</span>
                  <span class="p">};</span>

                  <span class="c1">// Add start and end points to request data.</span>
                  <span class="kd">const</span> <span class="nx">data</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FormData</span><span class="p">();</span>
                  <span class="nx">data</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="dl">'</span><span class="s1">start</span><span class="dl">'</span><span class="p">,</span> <span class="nx">start</span><span class="p">);</span>
                  <span class="nx">data</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="dl">'</span><span class="s1">end</span><span class="dl">'</span><span class="p">,</span> <span class="nx">end</span><span class="p">);</span>

                  <span class="c1">// Send request.</span>
                  <span class="nx">request</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
              <span class="p">};</span>

              <span class="c1">// Add a new post with given contents to DOM.</span>
              <span class="kd">function</span> <span class="nx">add_post</span><span class="p">(</span><span class="nx">contents</span><span class="p">)</span> <span class="p">{</span>

                  <span class="c1">// Create new post.</span>
                  <span class="kd">const</span> <span class="nx">post</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="dl">'</span><span class="s1">div</span><span class="dl">'</span><span class="p">);</span>
                  <span class="nx">post</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">post</span><span class="dl">'</span><span class="p">;</span>
                  <span class="nx">post</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">contents</span><span class="p">;</span>

                  <span class="c1">// Add post to DOM.</span>
                  <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">#posts</span><span class="dl">'</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">post</span><span class="p">);</span>
              <span class="p">};</span>
          <span class="nt">&lt;/script&gt;</span>
      <span class="nt">&lt;/head&gt;</span>
      <span class="nt">&lt;body&gt;</span>
          <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"posts"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;/div&gt;</span>
      <span class="nt">&lt;/body&gt;</span>
  <span class="nt">&lt;/html&gt;</span>
</code></pre></div>    </div>
  </li>
  <li data-marker="*">For a little more functionality, the <code class="highlighter-rouge">add_post</code> function could be modified to add a button to hide uninteresting posts.
    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">function</span> <span class="nx">add_post</span><span class="p">(</span><span class="nx">contents</span><span class="p">)</span> <span class="p">{</span>

      <span class="c1">// Create new post.</span>
      <span class="kd">const</span> <span class="nx">post</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="dl">'</span><span class="s1">div</span><span class="dl">'</span><span class="p">);</span>
      <span class="nx">post</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">post</span><span class="dl">'</span><span class="p">;</span>
      <span class="nx">post</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">contents</span><span class="p">;</span>

      <span class="c1">// Add button to hide post.</span>
      <span class="kd">const</span> <span class="nx">hide</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="dl">'</span><span class="s1">button</span><span class="dl">'</span><span class="p">);</span>
      <span class="nx">hide</span><span class="p">.</span><span class="nx">className</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">hide</span><span class="dl">'</span><span class="p">;</span>
      <span class="nx">hide</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">Hide</span><span class="dl">'</span><span class="p">;</span>
      <span class="nx">post</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">hide</span><span class="p">);</span>

      <span class="c1">// When hide button is clicked, remove post.</span>
      <span class="nx">hide</span><span class="p">.</span><span class="nx">onclick</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">parentElement</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
      <span class="p">};</span>

      <span class="c1">// Add post to DOM.</span>
      <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">#posts</span><span class="dl">'</span><span class="p">).</span><span class="nx">append</span><span class="p">(</span><span class="nx">post</span><span class="p">);</span>
  <span class="p">};</span>
</code></pre></div>    </div>
    <ul>
      <li data-marker="*">Calling <code class="highlighter-rouge">post.append(hide)</code> adds the hide button inside the post <code class="highlighter-rouge">div</code>.</li>
      <li data-marker="*"><code class="highlighter-rouge">parentElement</code> is the element containing the element in question. In this case, <code class="highlighter-rouge">this.parentElement</code> is used to refer to the <code class="highlighter-rouge">post</code> containing the <code class="highlighter-rouge">hide</code> button.</li>
      <li data-marker="*"><code class="highlighter-rouge">remove</code> is a built-in function to delete an element all together.</li>
    </ul>
  </li>
</ul>

<h2 id="javascript-templating">JavaScript Templating</h2>

<ul>
  <li data-marker="*">One issue with using JavaScript to build more complicated user interfaces and adding items to the DOM the code is starting to get a little bit messy. Every element needs to be created, class names need to be assigned, inner HTML needs to be set, etc. Ideally, all the HTML would be written somewhere else, but the exact content that’s going inside is still currently unknown.</li>
  <li data-marker="*">The solution to this problem is JavaScript templating, which allows for the creation of templates in JavaScript that define the HTML, while also allowing for substitution inside that template for adding different content. A very simple version of this is JavaScript’s template literals. There many different JavaScript libraries that take that idea one step further. In this class, the Handlebars library will be used.</li>
  <li data-marker="*">The next series of examples will be a dice-throwing application. Here’s the starting point.
    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nt">&lt;html&gt;</span>
      <span class="nt">&lt;head&gt;</span>
          <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.11/handlebars.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
          <span class="nt">&lt;script&gt;</span>
              <span class="c1">// Template for roll results</span>
              <span class="kd">const</span> <span class="nx">template</span> <span class="o">=</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">compile</span><span class="p">(</span><span class="dl">"</span><span class="s2">&lt;li&gt;You rolled a &lt;/li&gt;</span><span class="dl">"</span><span class="p">);</span>

              <span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">DOMContentLoaded</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
                  <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">#roll</span><span class="dl">'</span><span class="p">).</span><span class="nx">onclick</span> <span class="o">=</span> <span class="p">()</span>  <span class="o">=&gt;</span> <span class="p">{</span>

                      <span class="c1">// Generate a random roll.</span>
                      <span class="kd">const</span> <span class="nx">roll</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">((</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>

                      <span class="c1">// Add roll result to DOM.</span>
                      <span class="kd">const</span> <span class="nx">content</span> <span class="o">=</span> <span class="nx">template</span><span class="p">({</span><span class="dl">'</span><span class="s1">value</span><span class="dl">'</span><span class="p">:</span> <span class="nx">roll</span><span class="p">});</span>
                      <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">#rolls</span><span class="dl">'</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">+=</span> <span class="nx">content</span><span class="p">;</span>
                  <span class="p">};</span>
              <span class="p">});</span>
          <span class="nt">&lt;/script&gt;</span>
      <span class="nt">&lt;/head&gt;</span>
      <span class="nt">&lt;body&gt;</span>
          <span class="nt">&lt;button</span> <span class="na">id=</span><span class="s">"roll"</span><span class="nt">&gt;</span>Roll<span class="nt">&lt;/button&gt;</span>
          <span class="nt">&lt;ul</span> <span class="na">id=</span><span class="s">"rolls"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;/ul&gt;</span>
      <span class="nt">&lt;/body&gt;</span>
  <span class="nt">&lt;/html&gt;</span>
</code></pre></div>    </div>
    <ul>
      <li data-marker="*"><code class="highlighter-rouge">template</code> is being used repeatedly for every roll. It is like a client-side analog to the Flask/Jinja2 templates.</li>
      <li data-marker="*"><code class="highlighter-rouge">Math.random()</code> returns a random number between 0 and 1. Multiplying it by 6 returns a number in the range of 0 up to, but not including, 6. Adding 1 gives a range from 1 up to 7, and using <code class="highlighter-rouge">Math.floor()</code> will return either 1, 2, 3, 4, 5, or 6.</li>
      <li data-marker="*"><code class="highlighter-rouge">template</code> is used like function: it is passed value(s) and returns HTML content.</li>
    </ul>
  </li>
  <li data-marker="*">It would be nicer to have images of the dice roll rather than just printing out the number. To do so, all that needs to change is the template, which now includes an <code class="highlighter-rouge">img</code> element.
    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">const</span> <span class="nx">template</span> <span class="o">=</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">compile</span><span class="p">(</span><span class="dl">"</span><span class="s2">&lt;li&gt;You rolled: &lt;img src=</span><span class="se">\"</span><span class="s2">img/.png</span><span class="se">\"</span><span class="s2">&gt;&lt;/li&gt;</span><span class="dl">"</span><span class="p">);</span>
</code></pre></div>    </div>
    <ul>
      <li data-marker="*">Note how the <code class="highlighter-rouge">"</code> characters are escaped, since they are inside a string.</li>
    </ul>
  </li>
  <li data-marker="*">Still, including all of the JavaScript template inside a string starts to get messy when including images, etc. Ideally, there would be pure HTML that is then compiled by Handlebars.
    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nt">&lt;script </span><span class="na">id=</span><span class="s">"result"</span> <span class="na">type=</span><span class="s">"text/x-handlebars-template"</span><span class="nt">&gt;</span>
      <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span>
          <span class="nx">You</span> <span class="nx">rolled</span><span class="p">:</span>
            
          <span class="o">&lt;</span><span class="nx">img</span> <span class="nx">alt</span><span class="o">=</span><span class="dl">"</span><span class="s2">{{ value }}</span><span class="dl">"</span> <span class="nx">title</span><span class="o">=</span><span class="dl">"</span><span class="s2">{{ value }}</span><span class="dl">"</span> <span class="nx">src</span><span class="o">=</span><span class="dl">"</span><span class="s2">img/{{ value }}.png</span><span class="dl">"</span><span class="o">&gt;&lt;</span><span class="sr">/img</span><span class="err">&gt;
</span>            
      <span class="o">&lt;</span><span class="sr">/li</span><span class="err">&gt;
</span>  <span class="nt">&lt;/script&gt;</span>
  <span class="nt">&lt;script&gt;</span>
      <span class="c1">// Template for roll results</span>
      <span class="kd">const</span> <span class="nx">template</span> <span class="o">=</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">compile</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">#result</span><span class="dl">'</span><span class="p">).</span><span class="nx">innerHTML</span><span class="p">);</span>

      <span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">DOMContentLoaded</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">#roll</span><span class="dl">'</span><span class="p">).</span><span class="nx">onclick</span> <span class="o">=</span> <span class="p">()</span>  <span class="o">=&gt;</span> <span class="p">{</span>

              <span class="c1">// Generate a random roll.</span>
              <span class="kd">const</span> <span class="nx">roll</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">((</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>

              <span class="c1">// Add roll result to DOM.</span>
              <span class="kd">const</span> <span class="nx">content</span> <span class="o">=</span> <span class="nx">template</span><span class="p">({</span><span class="dl">'</span><span class="s1">value</span><span class="dl">'</span><span class="p">:</span> <span class="nx">roll</span><span class="p">});</span>
              <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">#rolls</span><span class="dl">'</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">+=</span> <span class="nx">content</span><span class="p">;</span>
          <span class="p">};</span>
      <span class="p">});</span>
  <span class="nt">&lt;/script&gt;</span>
</code></pre></div>    </div>
    <ul>
      <li data-marker="*">Note that there are two <code class="highlighter-rouge">script</code> elements. The one with the id <code class="highlighter-rouge">result</code> with represent the result of a roll. It has a special <code class="highlighter-rouge">type</code> attribute, defined by Handlebars. Inside of this <code class="highlighter-rouge">script</code> element will be HTML code that represents the Handlebars template.</li>
      <li data-marker="*">The <code class="highlighter-rouge">alt</code> and <code class="highlighter-rouge">title</code> attributes of the image simply provide the same information in text when the image is hovered over and for browsers that don’t support images.</li>
      <li data-marker="*">Now, instead of compiling a string, the template is simply selected using <code class="highlighter-rouge">document.querySelector</code>.</li>
    </ul>
  </li>
  <li data-marker="*">Handlebars, like Jinja, supports loops. In this example, loops could be used to roll multiple dice at once.
    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nt">&lt;html&gt;</span>
      <span class="nt">&lt;head&gt;</span>
          <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.11/handlebars.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
          <span class="nt">&lt;script </span><span class="na">id=</span><span class="s">"result"</span> <span class="na">type=</span><span class="s">"text/template"</span><span class="nt">&gt;</span>
              <span class="o">&lt;</span><span class="nx">li</span><span class="o">&gt;</span>
                  <span class="nx">You</span> <span class="nx">rolled</span><span class="p">:</span>
                    
                  <span class="p">{{</span><span class="err">#</span><span class="nx">each</span> <span class="nx">values</span><span class="p">}}</span>
                      <span class="o">&lt;</span><span class="nx">img</span> <span class="nx">alt</span><span class="o">=</span><span class="dl">"</span><span class="s2">{{ this }}</span><span class="dl">"</span> <span class="nx">title</span><span class="o">=</span><span class="dl">"</span><span class="s2">{{ this }}</span><span class="dl">"</span> <span class="nx">src</span><span class="o">=</span><span class="dl">"</span><span class="s2">img/{{ this }}.png</span><span class="dl">"</span><span class="o">&gt;</span>
                  <span class="p">{{</span><span class="o">/</span><span class="nx">each</span><span class="p">}}</span>
                  <span class="p">(</span><span class="na">Total</span><span class="p">:</span> <span class="p">{{</span> <span class="nx">total</span> <span class="p">}})</span>
                    
              <span class="o">&lt;</span><span class="sr">/li</span><span class="err">&gt;
</span>          <span class="nt">&lt;/script&gt;</span>
          <span class="nt">&lt;script&gt;</span>

              <span class="c1">// Template for roll results</span>
              <span class="kd">const</span> <span class="nx">template</span> <span class="o">=</span> <span class="nx">Handlebars</span><span class="p">.</span><span class="nx">compile</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">#result</span><span class="dl">'</span><span class="p">).</span><span class="nx">innerHTML</span><span class="p">);</span>

              <span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">DOMContentLoaded</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
                  <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">#roll</span><span class="dl">'</span><span class="p">).</span><span class="nx">onclick</span> <span class="o">=</span> <span class="p">()</span>  <span class="o">=&gt;</span> <span class="p">{</span>

                      <span class="c1">// Generate random rolls.</span>
                      <span class="kd">const</span> <span class="nx">counter</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">#counter</span><span class="dl">'</span><span class="p">).</span><span class="nx">value</span><span class="p">);</span>
                      <span class="kd">const</span> <span class="nx">rolls</span> <span class="o">=</span> <span class="p">[];</span>
                      <span class="kd">let</span> <span class="nx">total</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                      <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">counter</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                          <span class="kd">const</span> <span class="nx">value</span> <span class="o">=</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">6</span><span class="p">)</span> <span class="o">+</span>  <span class="mi">1</span><span class="p">;</span>
                          <span class="nx">rolls</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">value</span><span class="p">);</span>
                          <span class="nx">total</span> <span class="o">+=</span> <span class="nx">value</span><span class="p">;</span>
                      <span class="p">};</span>

                      <span class="c1">// Add roll results to DOM.</span>
                      <span class="kd">const</span> <span class="nx">content</span> <span class="o">=</span> <span class="nx">template</span><span class="p">({</span><span class="dl">'</span><span class="s1">values</span><span class="dl">'</span><span class="p">:</span> <span class="nx">rolls</span><span class="p">,</span> <span class="dl">'</span><span class="s1">total</span><span class="dl">'</span><span class="p">:</span> <span class="nx">total</span><span class="p">});</span>
                      <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">#rolls</span><span class="dl">'</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">+=</span> <span class="nx">content</span><span class="p">;</span>
                  <span class="p">};</span>
              <span class="p">});</span>
          <span class="nt">&lt;/script&gt;</span>
      <span class="nt">&lt;/head&gt;</span>
      <span class="nt">&lt;body&gt;</span>
          <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">"counter"</span> <span class="na">type=</span><span class="s">"number"</span> <span class="na">placeholder=</span><span class="s">"Number of Rolls"</span> <span class="na">min=</span><span class="s">"1"</span> <span class="na">value=</span><span class="s">"1"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;button</span> <span class="na">id=</span><span class="s">"roll"</span><span class="nt">&gt;</span>Roll<span class="nt">&lt;/button&gt;</span>
          <span class="nt">&lt;ul</span> <span class="na">id=</span><span class="s">"rolls"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;/ul&gt;</span>
      <span class="nt">&lt;/body&gt;</span>
  <span class="nt">&lt;/html&gt;</span>
</code></pre></div>    </div>
    <ul>
      <li data-marker="*"><code class="highlighter-rouge">#each</code> is a Handlebars ‘block helper’. There many of these helpers with different functions, be it loops, in this examples, conditionals (<code class="highlighter-rouge">#if</code>), etc. If the built-in helpers aren’t enough, Handlebars also allows for the creation of custom helpers.</li>
      <li data-marker="*">Inside the loop, Handlebars calls every item in the set of items (in this case, the set is called <code class="highlighter-rouge">values</code>), <code class="highlighter-rouge">this</code>.</li>
    </ul>
  </li>
  <li data-marker="*">
    <p>One thing to keep in mind when adding Handlebars templates to Flask apps is that Jinja will scan the HTML file first, and will see the double curly brace syntax as a place where it should plug in a value. Since this is not desired, Jinja needs to be told to ignore the blocks of code with Handlebars templates with Jinja’s <code class="highlighter-rouge">raw</code> block.</p>

    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  {% raw -%}
      {{ contents }}
  {%- endraw %}
</code></pre></div>    </div>
  </li>
</ul>

<h2 id="css-animation">CSS Animation</h2>

<ul>
  <li data-marker="*">CSS animation allows for changes from one CSS property to another over some duration of time while the page is running.
    <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    
  <span class="k">@keyframes</span> <span class="n">grow</span> <span class="p">{</span>
      <span class="nt">from</span> <span class="p">{</span>
          <span class="nl">font-size</span><span class="p">:</span> <span class="m">20px</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nt">to</span>  <span class="p">{</span>
          <span class="nl">font-size</span><span class="p">:</span> <span class="m">100px</span><span class="p">;</span>
      <span class="p">}</span>
  <span class="p">}</span>


  <span class="nt">h1</span> <span class="p">{</span>
      <span class="nl">animation-name</span><span class="p">:</span> <span class="n">grow</span><span class="p">;</span>
      <span class="nl">animation-duration</span><span class="p">:</span> <span class="m">2s</span><span class="p">;</span>
      <span class="nl">animation-fill-mode</span><span class="p">:</span> <span class="n">forwards</span><span class="p">;</span>
  <span class="p">}</span>
    
</code></pre></div>    </div>
    <ul>
      <li data-marker="*"><code class="highlighter-rouge">@keyframes grow</code> defines a CSS animation called <code class="highlighter-rouge">grow</code>, which goes <code class="highlighter-rouge">from</code> one style <code class="highlighter-rouge">to</code> another style.</li>
      <li data-marker="*">The <code class="highlighter-rouge">animation-name</code> property is used to link the <code class="highlighter-rouge">grow</code> animation to <code class="highlighter-rouge">h1</code> elements.</li>
      <li data-marker="*"><code class="highlighter-rouge">animation-duration</code> sets the time over which the animation occurs.</li>
      <li data-marker="*"><code class="highlighter-rouge">animation-fill-mode</code> sets the direction the animation should go. The value <code class="highlighter-rouge">forwards</code> means that once the end of the animation is reached, that final styling should be preserved.</li>
    </ul>
  </li>
  <li data-marker="*">Another simple example:
    <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    
  <span class="k">@keyframes</span> <span class="n">move</span> <span class="p">{</span>
      <span class="nt">from</span> <span class="p">{</span>
          <span class="nl">left</span><span class="p">:</span> <span class="m">0%</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nt">to</span>  <span class="p">{</span>
          <span class="nl">left</span><span class="p">:</span> <span class="m">50%</span><span class="p">;</span>
      <span class="p">}</span>
  <span class="p">}</span>

  <span class="nt">h1</span> <span class="p">{</span>
      <span class="nl">position</span><span class="p">:</span> <span class="nb">relative</span><span class="p">;</span>
      <span class="nl">animation-name</span><span class="p">:</span> <span class="n">move</span><span class="p">;</span>
      <span class="nl">animation-duration</span><span class="p">:</span> <span class="m">3s</span><span class="p">;</span>
      <span class="nl">animation-fill-mode</span><span class="p">:</span> <span class="n">forwards</span><span class="p">;</span>
  <span class="p">}</span>
    
</code></pre></div>    </div>
    <ul>
      <li data-marker="*"><code class="highlighter-rouge">left</code> indicates the relative position of an HTML element. <code class="highlighter-rouge">h1</code> is given the <code class="highlighter-rouge">position: relative</code> property, which means it position is defined in relationship to other parts of the window.</li>
      <li data-marker="*">The <code class="highlighter-rouge">move</code> animation shifts an element from being 0% away from the left edge of the screen to being 50% away from that edge (aligned with the middle of the window).</li>
    </ul>
  </li>
  <li data-marker="*">Along with a start and end point, midway points can be specified as well.
    <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    
  <span class="k">@keyframes</span> <span class="n">move</span> <span class="p">{</span>
      <span class="nt">0</span><span class="o">%</span> <span class="p">{</span>
          <span class="nl">left</span><span class="p">:</span> <span class="m">0%</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nt">50</span><span class="o">%</span> <span class="p">{</span>
          <span class="nl">left</span><span class="p">:</span> <span class="m">50%</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nt">100</span><span class="o">%</span> <span class="p">{</span>
          <span class="nl">left</span><span class="p">:</span> <span class="m">0%</span><span class="p">;</span>
      <span class="p">}</span>
  <span class="p">}</span>
    
</code></pre></div>    </div>
  </li>
</ul>

<h3 id="adding-javascript">Adding JavaScript</h3>

<ul>
  <li data-marker="*">With CSS alone, animations always run as soon as a webpage is loaded. To control animation, JavaScript can be used to modify the CSS properties <code class="highlighter-rouge">animationPlayState</code>, which is <code class="highlighter-rouge">paused</code> or <code class="highlighter-rouge">running</code>.
    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    
  <span class="nt">&lt;style&gt;</span>
      <span class="k">@keyframes</span> <span class="n">move</span> <span class="p">{</span>
          <span class="nt">0</span><span class="o">%</span> <span class="p">{</span>
              <span class="nl">left</span><span class="p">:</span> <span class="m">0%</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="nt">50</span><span class="o">%</span> <span class="p">{</span>
              <span class="nl">left</span><span class="p">:</span> <span class="m">50%</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="nt">100</span><span class="o">%</span> <span class="p">{</span>
              <span class="nl">left</span><span class="p">:</span> <span class="m">0%</span><span class="p">;</span>
          <span class="p">}</span>
      <span class="p">}</span>

      <span class="nt">h1</span> <span class="p">{</span>
          <span class="nl">position</span><span class="p">:</span> <span class="nb">relative</span><span class="p">;</span>
          <span class="nl">animation-name</span><span class="p">:</span> <span class="n">move</span><span class="p">;</span>
          <span class="nl">animation-duration</span><span class="p">:</span> <span class="m">3s</span><span class="p">;</span>
          <span class="nl">animation-fill-mode</span><span class="p">:</span> <span class="n">forwards</span><span class="p">;</span>
          <span class="nl">animation-iteration-count</span><span class="p">:</span> <span class="n">infinite</span><span class="p">;</span>
      <span class="p">}</span>
      
  <span class="nt">&lt;/style&gt;</span>
  <span class="nt">&lt;script&gt;</span>
      <span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">DOMContentLoaded</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="kd">const</span> <span class="nx">h1</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">h1</span><span class="dl">'</span><span class="p">);</span>
          <span class="nx">h1</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">animationPlayState</span>  <span class="o">=</span> <span class="dl">'</span><span class="s1">paused</span><span class="dl">'</span><span class="p">;</span>
          <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">button</span><span class="dl">'</span><span class="p">).</span><span class="nx">onclick</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
              <span class="k">if</span> <span class="p">(</span><span class="nx">h1</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">animationPlayState</span>  <span class="o">===</span> <span class="dl">'</span><span class="s1">paused</span><span class="dl">'</span><span class="p">)</span>
                  <span class="nx">h1</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">animationPlayState</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">running</span><span class="dl">'</span><span class="p">;</span>
              <span class="k">else</span>
                  <span class="nx">h1</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">animationPlayState</span>  <span class="o">=</span> <span class="dl">'</span><span class="s1">paused</span><span class="dl">'</span><span class="p">;</span>
          <span class="p">};</span>
      <span class="p">});</span>
  <span class="nt">&lt;/script&gt;</span>
</code></pre></div>    </div>
    <ul>
      <li data-marker="*"><code class="highlighter-rouge">animation-iteration-count</code> specifies how many times the animation should be run.</li>
      <li data-marker="*">When the page is first loaded, the animation is paused. Then, everytime some button is clicked, the <code class="highlighter-rouge">animationPlayState</code> is changed.</li>
    </ul>
  </li>
  <li data-marker="*">So far, animation has been purely aesthetic, but it can be a large part of a good user interface. One such situation might be the previous example with a list of posts. When hiding a post, it would helpful to have the post fade away.
    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nt">&lt;style&gt;</span>
    
      <span class="k">@keyframes</span> <span class="nb">hide</span> <span class="p">{</span>
          <span class="nt">from</span> <span class="p">{</span>
              <span class="nl">opacity</span><span class="p">:</span> <span class="m">1</span><span class="p">;</span>
          <span class="p">}</span>
          <span class="nt">to</span> <span class="p">{</span>
              <span class="nl">opacity</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
          <span class="p">}</span>
      <span class="p">}</span>

      <span class="nc">.post</span> <span class="p">{</span>
          <span class="nl">background-color</span><span class="p">:</span> <span class="m">#77dd11</span><span class="p">;</span>
          <span class="nl">padding</span><span class="p">:</span> <span class="m">20px</span><span class="p">;</span>
          <span class="nl">margin-bottom</span><span class="p">:</span> <span class="m">10px</span><span class="p">;</span>
          <span class="nl">animation-name</span><span class="p">:</span> <span class="nb">hide</span><span class="p">;</span>
          <span class="nl">animation-duration</span><span class="p">:</span> <span class="m">2s</span><span class="p">;</span>
          <span class="nl">animation-fill-mode</span><span class="p">:</span> <span class="n">forwards</span><span class="p">;</span>
          <span class="nl">animation-play-state</span><span class="p">:</span> <span class="n">paused</span><span class="p">;</span>
      <span class="p">}</span>
  <span class="nt">&lt;/style&gt;</span>
  <span class="nt">&lt;script&gt;</span>
      <span class="c1">// ...rest of JavaScript code...</span>

      <span class="c1">// If hide button is clicked, delete the post.</span>
      <span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">click</span><span class="dl">'</span><span class="p">,</span> <span class="nx">event</span> <span class="o">=&gt;</span> <span class="p">{</span>
          <span class="kd">const</span> <span class="nx">element</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">;</span>
          <span class="k">if</span> <span class="p">(</span><span class="nx">element</span><span class="p">.</span><span class="nx">className</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">hide</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
              <span class="nx">element</span><span class="p">.</span><span class="nx">parentElement</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">animationPlayState</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">running</span><span class="dl">'</span><span class="p">;</span>
              <span class="nx">element</span><span class="p">.</span><span class="nx">parentElement</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">animationend</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span>  <span class="p">{</span>
                  <span class="nx">element</span><span class="p">.</span><span class="nx">parentElement</span><span class="p">.</span><span class="nx">remove</span><span class="p">();</span>
              <span class="p">});</span>
          <span class="p">}</span>
      <span class="p">});</span>
  <span class="nt">&lt;/script&gt;</span>
    
</code></pre></div>    </div>
    <ul>
      <li data-marker="*">There is slightly different logic here to figure out when the button is clicked. Now, anytime a mouse click occurs, the <code class="highlighter-rouge">event.target</code>, which is the element being clicked, is assigned to the variable <code class="highlighter-rouge">element</code>.</li>
      <li data-marker="*">If the hide button was clicked, the animation is run on the post, and the end of the animation is listened for with a callback to actually delete the post.</li>
    </ul>
  </li>
  <li data-marker="*">A slight refinement would be to have the rest of the posts slide up to fill the gap left by the deleted post. To give this illusion, only the actual post being deleted needs to have its animation modified, not all the posts remaining.
    <div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    
  <span class="k">@keyframes</span> <span class="nb">hide</span> <span class="p">{</span>
      <span class="nt">0</span><span class="o">%</span> <span class="p">{</span>
          <span class="nl">opacity</span><span class="p">:</span> <span class="m">1</span><span class="p">;</span>
          <span class="nl">height</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
          <span class="nl">line-height</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
          <span class="nl">padding</span><span class="p">:</span> <span class="m">20px</span><span class="p">;</span>
          <span class="nl">margin-bottom</span><span class="p">:</span> <span class="m">10px</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nt">75</span><span class="o">%</span> <span class="p">{</span>
          <span class="nl">opacity</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
          <span class="nl">height</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
          <span class="nl">line-height</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
          <span class="nl">padding</span><span class="p">:</span> <span class="m">20px</span><span class="p">;</span>
          <span class="nl">margin-bottom</span><span class="p">:</span> <span class="m">10px</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="nt">100</span><span class="o">%</span> <span class="p">{</span>
          <span class="nl">opacity</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
          <span class="nl">height</span><span class="p">:</span> <span class="m">0px</span><span class="p">;</span>
          <span class="nl">line-height</span><span class="p">:</span> <span class="m">0px</span><span class="p">;</span>
          <span class="nl">padding</span><span class="p">:</span> <span class="m">0px</span><span class="p">;</span>
          <span class="nl">margin-bottom</span><span class="p">:</span> <span class="m">0px</span><span class="p">;</span>
      <span class="p">}</span>
  <span class="p">}</span>
    
</code></pre></div>    </div>
    <ul>
      <li data-marker="*">For the first 75% of the animation, the post disappears.</li>
      <li data-marker="*">For the final 25% of the animation, the post shrinks in size until it has no height, causing all the other posts below it to fill in that space.</li>
    </ul>
  </li>
</ul>

<h2 id="svg-animation">SVG Animation</h2>

<ul>
  <li data-marker="*">A Scalable Vector Graphic (SVG) is graphical element determined by lines, angles, and shapes. SVGs can be used to draw things that simple HTML elements, like <code class="highlighter-rouge">div</code>s, don’t allow for.
    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nt">&lt;body&gt;</span>
      <span class="nt">&lt;svg</span> <span class="na">style=</span><span class="s">"width:100%; height:800px"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;circle</span> <span class="na">cx=</span><span class="s">"200"</span> <span class="na">cy=</span><span class="s">"200"</span> <span class="na">r=</span><span class="s">"50"</span> <span class="na">style=</span><span class="s">"fill:blue"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/svg&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
</code></pre></div>    </div>
    <ul>
      <li data-marker="*">The SVG element is given a fixed <code class="highlighter-rouge">height</code> and a <code class="highlighter-rouge">width</code> that automatically adjusts based on the content to maintain that fixed height.</li>
      <li data-marker="*">The <code class="highlighter-rouge">circle</code> element is one of the SVG elements supported by SVG. It is given x- and y-coordinates for its center with <code class="highlighter-rouge">cx</code> and <code class="highlighter-rouge">cy</code>, a radius with <code class="highlighter-rouge">r</code>, and finally some CSS styling.</li>
    </ul>
  </li>
  <li data-marker="*">As before, it is preferable to be able to create such elements programatically using JavaScript. To do so, a JavaScript data visualization library, D3, will be used.
    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nt">&lt;html&gt;</span>
      <span class="nt">&lt;head&gt;</span>
          <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://d3js.org/d3.v4.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
      <span class="nt">&lt;/head&gt;</span>
      <span class="nt">&lt;body&gt;</span>
          <span class="nt">&lt;svg</span> <span class="na">id=</span><span class="s">"svg"</span> <span class="na">style=</span><span class="s">"width:100%; height:800px"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/body&gt;</span>
      <span class="nt">&lt;script&gt;</span>

          <span class="kd">const</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="dl">'</span><span class="s1">#svg</span><span class="dl">'</span><span class="p">);</span>

          <span class="nx">svg</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="dl">'</span><span class="s1">circle</span><span class="dl">'</span><span class="p">)</span>
             <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">cx</span><span class="dl">'</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
             <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">cy</span><span class="dl">'</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
             <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">r</span><span class="dl">'</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>
             <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="dl">'</span><span class="s1">fill</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">green</span><span class="dl">'</span><span class="p">);</span>

      <span class="nt">&lt;/script&gt;</span>
  <span class="nt">&lt;/html&gt;</span>
</code></pre></div>    </div>
    <ul>
      <li data-marker="*"><code class="highlighter-rouge">d3.select</code> gets access to an HTML element.</li>
      <li data-marker="*">Then, D3 functions are used to add a circle to that selected SVG element with all the same attributes and styling as before.</li>
    </ul>
  </li>
  <li data-marker="*">As with CSS, animations can be added to SVGs.
    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">const</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="dl">'</span><span class="s1">#svg</span><span class="dl">'</span><span class="p">);</span>

  <span class="kd">const</span> <span class="nx">c</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="dl">'</span><span class="s1">circle</span><span class="dl">'</span><span class="p">)</span>
               <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">cx</span><span class="dl">'</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
               <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">cy</span><span class="dl">'</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
               <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">r</span><span class="dl">'</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
               <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="dl">'</span><span class="s1">fill</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">blue</span><span class="dl">'</span><span class="p">);</span>

  <span class="nx">c</span><span class="p">.</span><span class="nx">transition</span><span class="p">()</span>
   <span class="p">.</span><span class="nx">duration</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
   <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">cx</span><span class="dl">'</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
   <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">cy</span><span class="dl">'</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
   <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="dl">'</span><span class="s1">fill</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">red</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div>    </div>
    <ul>
      <li data-marker="*">The duration (in milliseconds) for the <code class="highlighter-rouge">transition</code> (animation) is given, along with the final values for each attribute that should be animated.</li>
    </ul>
  </li>
  <li data-marker="*">Animations can also delayed or triggered on certain events.
    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nx">c</span><span class="p">.</span><span class="nx">transition</span><span class="p">()</span>
   <span class="p">.</span><span class="nx">duration</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
   <span class="p">.</span><span class="nx">delay</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
   <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">cx</span><span class="dl">'</span><span class="p">,</span> <span class="mi">500</span><span class="p">);</span>

  <span class="nx">c</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">click</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">transition</span><span class="p">()</span>
                     <span class="p">.</span><span class="nx">duration</span><span class="p">(</span><span class="mi">3000</span><span class="p">)</span>
                     <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="dl">'</span><span class="s1">fill</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">red</span><span class="dl">'</span><span class="p">);</span>
  <span class="p">});</span>
</code></pre></div>    </div>
    <ul>
      <li data-marker="*"><code class="highlighter-rouge">delay</code> specifies the length of time before the animation is run.</li>
      <li data-marker="*"><code class="highlighter-rouge">on</code> takes an event and callback to apply to an SVG. In this case, when the circle is clicked, <code class="highlighter-rouge">this</code>, whatever was clicked on, undergoes another transition.</li>
    </ul>
  </li>
</ul>

<h3 t="1h35m5s" id="a-drawing-application">A Drawing Application</h3>

<ul>
  <li data-marker="*">The final example of a user interface, demonstrating the potential of SVGs, will be a simple sketchpad-like application.
    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nt">&lt;body&gt;</span>
      <span class="nt">&lt;svg</span> <span class="na">id=</span><span class="s">"svg"</span> <span class="na">style=</span><span class="s">"width:100%; height:800px"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
  <span class="nt">&lt;script&gt;</span>

      <span class="kd">const</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="dl">'</span><span class="s1">#svg</span><span class="dl">'</span><span class="p">);</span>

      <span class="kd">function</span> <span class="nx">draw_point</span><span class="p">()</span> <span class="p">{</span>
          <span class="kd">const</span> <span class="nx">coords</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">mouse</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>

          <span class="nx">svg</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="dl">'</span><span class="s1">circle</span><span class="dl">'</span><span class="p">)</span>
             <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">cx</span><span class="dl">'</span><span class="p">,</span> <span class="nx">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
             <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">cy</span><span class="dl">'</span><span class="p">,</span> <span class="nx">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
             <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">r</span><span class="dl">'</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
             <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="dl">'</span><span class="s1">fill</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">black</span><span class="dl">'</span><span class="p">);</span>
      <span class="p">};</span>

      <span class="nx">svg</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">mousemove</span><span class="dl">'</span><span class="p">,</span> <span class="nx">draw_point</span><span class="p">);</span>

  <span class="nt">&lt;/script&gt;</span>
</code></pre></div>    </div>
    <ul>
      <li data-marker="*">Whenever the mouse moves on the canvas, <code class="highlighter-rouge">draw_point</code> will be called.</li>
      <li data-marker="*"><code class="highlighter-rouge">draw_point</code> simply draws a small circle where the mouse is, grabbing its coordinates with <code class="highlighter-rouge">d3.mouse(this)</code>.</li>
    </ul>
  </li>
  <li data-marker="*">An obvious improvement would be to only draw when the mouse is clicked.
    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="kd">const</span> <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="dl">'</span><span class="s1">#svg</span><span class="dl">'</span><span class="p">);</span>
  <span class="kd">let</span> <span class="nx">drawing</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

  <span class="kd">function</span> <span class="nx">draw_point</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">drawing</span><span class="p">)</span>
          <span class="k">return</span><span class="p">;</span>

      <span class="kd">const</span> <span class="nx">coords</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">mouse</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>

      <span class="nx">svg</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="dl">'</span><span class="s1">circle</span><span class="dl">'</span><span class="p">)</span>
         <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">cx</span><span class="dl">'</span><span class="p">,</span> <span class="nx">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
         <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">cy</span><span class="dl">'</span><span class="p">,</span> <span class="nx">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
         <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">r</span><span class="dl">'</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
         <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="dl">'</span><span class="s1">fill</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">black</span><span class="dl">'</span><span class="p">);</span>
  <span class="p">};</span>

  <span class="nx">svg</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">mousedown</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">drawing</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
  <span class="p">});</span>

  <span class="nx">svg</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">mouseup</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
      <span class="nx">drawing</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
  <span class="p">});</span>

  <span class="nx">svg</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">mousemove</span><span class="dl">'</span><span class="p">,</span> <span class="nx">draw_point</span><span class="p">);</span>
</code></pre></div>    </div>
    <ul>
      <li data-marker="*">Now, a boolean variable <code class="highlighter-rouge">drawing</code> controls whether or not a point should be drawn.</li>
      <li data-marker="*">Clicking (<code class="highlighter-rouge">mousedown</code>) turns on drawing by setting <code class="highlighter-rouge">drawing</code> to <code class="highlighter-rouge">true</code>, and releasing <code class="highlighter-rouge">mouseup</code> turns it off.</li>
    </ul>
  </li>
  <li data-marker="*">The remaining problem is that if the mouse moves too fast, a bunch of unconnected dots will be drawn because the <code class="highlighter-rouge">mousemove</code> event isn’t fired quickly enough. This frequency cannot be changed, but one workaround would be to draw a line between all points.</li>
  <li data-marker="*">First off, a nicer UI would include a list of options to let the user choose pen color, thickness, and also to erase the canvas.
    <div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nt">&lt;body&gt;</span>
      <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
          <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"options"</span> <span class="na">class=</span><span class="s">"row"</span><span class="nt">&gt;</span>
              <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"color-picker"</span><span class="nt">&gt;</span>
                  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"black"</span><span class="nt">&gt;</span>Black<span class="nt">&lt;/option&gt;</span>
                  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"red"</span><span class="nt">&gt;</span>Red<span class="nt">&lt;/option&gt;</span>
                  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"blue"</span><span class="nt">&gt;</span>Blue<span class="nt">&lt;/option&gt;</span>
                  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">"green"</span><span class="nt">&gt;</span>Green<span class="nt">&lt;/option&gt;</span>
              <span class="nt">&lt;/select&gt;</span>
              <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">"thickness-picker"</span><span class="nt">&gt;</span>
                  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">1</span><span class="nt">&gt;</span>1<span class="nt">&lt;/option&gt;</span>
                  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">2</span><span class="nt">&gt;</span>2<span class="nt">&lt;/option&gt;</span>
                  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">3</span> <span class="na">selected</span><span class="nt">&gt;</span>3<span class="nt">&lt;/option&gt;</span>
                  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">4</span><span class="nt">&gt;</span>4<span class="nt">&lt;/option&gt;</span>
                  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">5</span><span class="nt">&gt;</span>5<span class="nt">&lt;/option&gt;</span>
                  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">6</span><span class="nt">&gt;</span>6<span class="nt">&lt;/option&gt;</span>
                  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">7</span><span class="nt">&gt;</span>7<span class="nt">&lt;/option&gt;</span>
                  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">8</span><span class="nt">&gt;</span>8<span class="nt">&lt;/option&gt;</span>
                  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">9</span><span class="nt">&gt;</span>9<span class="nt">&lt;/option&gt;</span>
                  <span class="nt">&lt;option</span> <span class="na">value=</span><span class="s">10</span><span class="nt">&gt;</span>10<span class="nt">&lt;/option&gt;</span>
              <span class="nt">&lt;/select&gt;</span>
              <span class="nt">&lt;button</span> <span class="na">id=</span><span class="s">"erase"</span><span class="nt">&gt;</span>Erase<span class="nt">&lt;/button&gt;</span>
          <span class="nt">&lt;/div&gt;</span>
      <span class="nt">&lt;/div&gt;</span>
      <span class="nt">&lt;svg</span> <span class="na">id=</span><span class="s">"draw"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;/svg&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
</code></pre></div>    </div>
  </li>
  <li data-marker="*">The more complex JavaScript now takes into account these features.
    <div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nb">document</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">DOMContentLoaded</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>

      <span class="c1">// state</span>
      <span class="kd">let</span> <span class="nx">draw</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

      <span class="c1">// elements</span>
      <span class="kd">let</span> <span class="nx">points</span> <span class="o">=</span> <span class="p">[];</span>
      <span class="kd">let</span> <span class="nx">lines</span> <span class="o">=</span> <span class="p">[];</span>
      <span class="kd">let</span> <span class="nx">svg</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>

      <span class="kd">function</span> <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>

          <span class="c1">// create the selection area</span>
          <span class="nx">svg</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">select</span><span class="p">(</span><span class="dl">'</span><span class="s1">#draw</span><span class="dl">'</span><span class="p">)</span>
                  <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">height</span><span class="dl">'</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerHeight</span><span class="p">)</span>
                  <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">width</span><span class="dl">'</span><span class="p">,</span> <span class="nb">window</span><span class="p">.</span><span class="nx">innerWidth</span><span class="p">);</span>

          <span class="nx">svg</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">mousedown</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
              <span class="nx">draw</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
              <span class="kd">const</span> <span class="nx">coords</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">mouse</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
              <span class="nx">draw_point</span><span class="p">(</span><span class="nx">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="kc">false</span><span class="p">);</span>
          <span class="p">});</span>

          <span class="nx">svg</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">mouseup</span><span class="dl">'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span><span class="p">{</span>
              <span class="nx">draw</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
          <span class="p">});</span>

          <span class="nx">svg</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">mousemove</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
              <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">draw</span><span class="p">)</span>
                  <span class="k">return</span><span class="p">;</span>
              <span class="kd">const</span> <span class="nx">coords</span> <span class="o">=</span> <span class="nx">d3</span><span class="p">.</span><span class="nx">mouse</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
              <span class="nx">draw_point</span><span class="p">(</span><span class="nx">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
          <span class="p">});</span>

          <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">#erase</span><span class="dl">'</span><span class="p">).</span><span class="nx">onclick</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
              <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">points</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span>
                  <span class="nx">points</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">remove</span><span class="p">();</span>
              <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">lines</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span>
                  <span class="nx">lines</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">remove</span><span class="p">();</span>
              <span class="nx">points</span> <span class="o">=</span> <span class="p">[];</span>
              <span class="nx">lines</span> <span class="o">=</span> <span class="p">[];</span>
          <span class="p">}</span>

      <span class="p">}</span>

      <span class="kd">function</span> <span class="nx">draw_point</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">,</span> <span class="nx">connect</span><span class="p">)</span> <span class="p">{</span>

          <span class="kd">const</span> <span class="nx">color</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">#color-picker</span><span class="dl">'</span><span class="p">).</span><span class="nx">value</span><span class="p">;</span>
          <span class="kd">const</span> <span class="nx">thickness</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">'</span><span class="s1">#thickness-picker</span><span class="dl">'</span><span class="p">).</span><span class="nx">value</span><span class="p">;</span>

          <span class="k">if</span> <span class="p">(</span><span class="nx">connect</span><span class="p">)</span> <span class="p">{</span>
              <span class="kd">const</span> <span class="nx">last_point</span> <span class="o">=</span> <span class="nx">points</span><span class="p">[</span><span class="nx">points</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">];</span>
              <span class="kd">const</span> <span class="nx">line</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="dl">'</span><span class="s1">line</span><span class="dl">'</span><span class="p">)</span>
                              <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">x1</span><span class="dl">'</span><span class="p">,</span> <span class="nx">last_point</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">cx</span><span class="dl">'</span><span class="p">))</span>
                              <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">y1</span><span class="dl">'</span><span class="p">,</span> <span class="nx">last_point</span><span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">cy</span><span class="dl">'</span><span class="p">))</span>
                              <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">x2</span><span class="dl">'</span><span class="p">,</span> <span class="nx">x</span><span class="p">)</span>
                              <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">y2</span><span class="dl">'</span><span class="p">,</span> <span class="nx">y</span><span class="p">)</span>
                              <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">stroke-width</span><span class="dl">'</span><span class="p">,</span> <span class="nx">thickness</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
                              <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="dl">'</span><span class="s1">stroke</span><span class="dl">'</span><span class="p">,</span> <span class="nx">color</span><span class="p">);</span>
              <span class="nx">lines</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">line</span><span class="p">);</span>
          <span class="p">}</span>

          <span class="kd">const</span> <span class="nx">point</span> <span class="o">=</span> <span class="nx">svg</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="dl">'</span><span class="s1">circle</span><span class="dl">'</span><span class="p">)</span>
                           <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">cx</span><span class="dl">'</span><span class="p">,</span> <span class="nx">x</span><span class="p">)</span>
                           <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">cy</span><span class="dl">'</span><span class="p">,</span> <span class="nx">y</span><span class="p">)</span>
                           <span class="p">.</span><span class="nx">attr</span><span class="p">(</span><span class="dl">'</span><span class="s1">r</span><span class="dl">'</span><span class="p">,</span> <span class="nx">thickness</span><span class="p">)</span>
                           <span class="p">.</span><span class="nx">style</span><span class="p">(</span><span class="dl">'</span><span class="s1">fill</span><span class="dl">'</span><span class="p">,</span> <span class="nx">color</span><span class="p">);</span>
          <span class="nx">points</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">point</span><span class="p">);</span>
      <span class="p">}</span>

      <span class="nx">render</span><span class="p">();</span>
  <span class="p">});</span>
</code></pre></div>    </div>
    <ul>
      <li data-marker="*">All points and lines are saved in arrays to allow them to be cleared when the user erases the canvas.</li>
      <li data-marker="*">Now, draw_point takes three arguments: the coordinates of the point and whether it should be connected to the previous point. It should not be connected when the mouse is clicked for the first time, but it should be connected whenever the mouse is moved.</li>
      <li data-marker="*">The <code class="highlighter-rouge">draw_point</code> function grabs the selected color and thickness, and, if the last point should be connected, it also grabs that point. A line with endpoints at the old point and the mouse location is then drawn and added to the array <code class="highlighter-rouge">lines</code>.</li>
      <li data-marker="*">The point is drawn as before, but also added to the array <code class="highlighter-rouge">points</code>.</li>
    </ul>
  </li>
</ul>


                </main>

            </div>

        </div>

        
 
    


</body>
<!-- Mirrored from cs50.harvard.edu/web/2018/notes/6/ by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 31 May 2020 07:07:59 GMT -->
</html>